# Magic file for the Universal Unpacker
# Special note: Have more specific definitions listed first!

0	string		\037\235	application/x-compress
0       string          \037\213	application/x-gzip
0	string		PK\003\004	application/x-zip
0	string          BZh             application/x-bzip2
0	string		BZ		application/x-bzip
0	string		\037\036	application/octet-stream
0	short		017437		application/octet-stream
0	string		PACK		application/x-pak
0	short		0x1fff		application/octet-stream
0	string		\377\037	application/octet-stream
0	short		0145405		application/octet-stream

0	short		070707		application/x-cpio
0	short		0143561		application/x-cpio
0	string		070707		application/x-cpio
0       string          070701          application/x-cpio
0       string          070702          application/x-cpio
0	string		\!<arch>\ndebian		application/x-debian-package
0	string		=<ar>			application/x-archive
0	string		\!<arch>			application/x-archive

0	string		KDE\ System\ V\ Init\ Editor	text/x-ksysv-log
4	string	KSysV 
>15	byte	>0x01	application/x-ksysv-package

# ISO files
32769	string		CD001			application/x-iso
32633	string		CD001			application/x-iso

# Partition table for a boot disk
# for FAT disk images
510   leshort 0xAA55				
>3	string	NTFS	application/x-ntfs
#>0	lelong&0x009000EB	0x009000EB	application/x-fat
#>0	lelong&0x000000E9	0x000000E9	application/x-fat
# fat12, fat16, etc.
>54	string	FAT1	application/x-fat
>82	string	FAT32	application/x-fat
>510   leshort 0xAA55  application/x-x86_boot
#>0              lelong&0x009000EB       0x009000EB 
#>0              lelong&0x000000E9       0x000000E9 
#>>1             ubyte                   >37 
#>>>11           uleshort        <2049 
#>>>>11          uleshort        >31 
#>>>>>16         ubyte           >2              application/x-fat
#>>>>>16         ubyte           =1              application/x-fat
#>>>>>16         ubyte           >0 
#>>>>>>54        string          FAT1            application/x-fat
#>>>>>82         string          FAT32           application/x-fat

# for EXT2/EXT3 file systems
0x438   leshort  0xEF53          
>0x44c  lelong   x               
>0x43e  leshort  x               
>0x45c  lelong   ^0x0000004      application/x-ext2
>0x45c  lelong   &0x0000004      application/x-ext3

0	string		/*\ XPM		image/x-xpm
0       string          #!/bin/sh               application/x-shellscript
0       string          #!\ /bin/sh             application/x-shellscript
0       string          #!/bin/csh              application/x-shellscript
0       string          #!\ /bin/csh            application/x-shellscript
0       string          #!/bin/ksh              application/x-shellscript
0       string          #!\ /bin/ksh            application/x-shellscript
0       string          #!/bin/zsh              application/x-shellscript
0       string          #!\ /bin/zsh            application/x-shellscript
0       string          #!/bin/tcsh             application/x-shellscript
0       string          #!\ /bin/tcsh           application/x-shellscript
0       string          #!/usr/local/tcsh       application/x-shellscript
0       string          #!\ /usr/local/tcsh     application/x-shellscript
0       string          #!/usr/local/bin/tcsh   application/x-shellscript
0       string          #!\ /usr/local/bin/tcsh application/x-shellscript
0       string          #!/bin/bash     		application/x-shellscript
0       string          #!\ /bin/bash           application/x-shellscript
0       string          #!/usr/local/bin/bash   application/x-shellscript
0       string          #!\ /usr/local/bin/bash application/x-shellscript
0       string          #!/usr/local/bin/zsh    application/x-shellscript
0       string          #!\ /usr/local/bin/zsh  application/x-shellscript
0       string          #!/usr/local/bin/ash    application/x-shellscript
0       string          #!\ /usr/local/bin/ash  application/x-shellscript
0       string          #!/bin/nawk             application/x-nawk
0       string          #!\ /bin/nawk           application/x-nawk
0       string          #!/usr/bin/nawk         application/x-nawk
0       string          #!\ /usr/bin/nawk       application/x-nawk
0       string          #!/usr/local/bin/nawk   application/x-nawk
0       string          #!\ /usr/local/bin/nawk application/x-nawk
0       string          #!/bin/gawk             application/x-gawk
0       string          #!\ /bin/gawk           application/x-gawk
0       string          #!/usr/bin/gawk         application/x-gawk
0       string          #!\ /usr/bin/gawk       application/x-gawk
0       string          #!/usr/local/bin/gawk   application/x-gawk
0       string          #!\ /usr/local/bin/gawk application/x-gawk
0       string          #!/bin/awk              application/x-awk
0       string          #!\ /bin/awk            application/x-awk
0       string          #!/usr/bin/awk          application/x-awk
0       string          #!\ /usr/bin/awk        application/x-awk
0       string          #!/bin/perl                     application/x-perl
0       string          #!\ /bin/perl                   application/x-perl
0       string          eval\ "exec\ /bin/perl          application/x-perl
0       string          #!/usr/bin/perl                 application/x-perl
0       string          #!\ /usr/bin/perl               application/x-perl
0       string          eval\ "exec\ /usr/bin/perl      application/x-perl
0       string          #!/usr/local/bin/perl           application/x-perl
0       string          #!\ /usr/local/bin/perl         application/x-perl
0       string          eval\ "exec\ /usr/local/bin/perl application/x-perl
0	string		#!/bin/env\ perl                 application/x-perl
0	string		#!\ /bin/env\ perl               application/x-perl
0	string		#!/usr/bin/env\ perl             application/x-perl
0	string		#!\ /usr/bin/env\ perl           application/x-perl
0	string		#!/bin/env\ ruby                   application/x-ruby
0	string		#!\ /bin/env\ ruby                 application/x-ruby
0	string		#!/usr/bin/env\ ruby               application/x-ruby
0	string		#!\ /usr/bin/env\ ruby             application/x-ruby

257	string		ustar\0		application/x-tar
257	string		ustar\040\040\0		application/x-tar

# Neal's special tar identification
# See magic(F) from Caldera.
# It is online at http://docsrv.sco.com:507/en/man/html.F/magic.F.html
0x61	long		0x20000000	application/x-tar
0x61	long		0x30000000	application/x-tar
0x61	long		0x31000000	application/x-tar

# RPM files
0       beshort         0xedab		application/x-rpm
>2      beshort         0xeedb          application/x-rpm

# Various archives
0	lelong&0x8080ffff	0x0000081a	application/x-arc
0	lelong&0x8080ffff	0x0000091a	application/x-arc
0	lelong&0x8080ffff	0x0000021a	application/x-arc
0	lelong&0x8080ffff	0x0000031a	application/x-arc
0	lelong&0x8080ffff	0x0000041a	application/x-arc
0	lelong&0x8080ffff	0x0000061a	application/x-arc
2	string	-lh0-	application/x-lha
2	string	-lh1-	application/x-lha
2	string	-lz4-	application/x-lha
2	string	-lz5-	application/x-lha
2	string	-lzs-	application/x-lha
2	string	-lh\40-	application/x-lha
2	string	-lhd-	application/x-lha
2	string	-lh2-	application/x-lha
2	string	-lh3-	application/x-lha
2	string	-lh4-	application/x-lha
2	string	-lh5-	application/x-lha
2	string	-lh6-	application/x-lha
2	string	-lh7-	application/x-lha
0	leshort		0xea60			application/x-arj
0	string		Rar!		application/x-rar
0	string		PK\003\004	application/x-zip
0	string		PK00PK\003\004	application/x-zip
20	lelong		0xfdc4a7dc	application/x-zoo
10	string	#\ This\ is\ a\ shell\ archive	application/x-shellscript
7      string        **ACE**     application/x-ace

# HTML?
0	string		\<HEAD	text/html
0	string		\<head	text/html
0	string		\<BODY	text/html
0	string		\<body	text/html
0	string		\<TITLE	text/html
0	string		\<title	text/html
0       string          \<html	text/html
0       string          \<HTML	text/html
0	string		\<!--	text/html
0	string		\<h1	text/html
0	string		\<H1	text/html
0	string		\<!doctype\ HTML	text/html
0	string		\<!DOCTYPE\ HTML	text/html
0	string		\<!doctype\ html	text/html
0	string		\<!DOCTYPE\ html	text/html
0	string		\<?php	application/x-php
0       string          \<?xml          text/xml
0       string          \<?XML          text/xml
0       string          \<?Xml          text/xml
0       string          diff\		text/x-diff
0       string          ***\		text/x-diff
0       string          Only\ in\ 	text/x-diff
0       string          Common\ subdirectories:\        text/x-diff

#############################
# Original reference: cabextract-1.1.tar.gz, doc/magic
# Microsoft CAB files
## Microsoft Cabinet file
0  string  MSCF\0\0\0\0    application/x-cab
## Installshield Cabinet file
0  string  ISc(    application/x-cab
## Microsoft WinCE install header
0  string  MSCE\0\0\0\0    application/x-cab

#############################
# UPX identification
0       string         MZ
>(60.l+248)   string   UPX0	application/x-upx
>0	string         MZ	application/x-exe

0       string	\177ELF
>0x78	string	\177UPX	application/x-upx
>0       string	\177ELF	application/x-elf

#############################
# Neal's special tar identification (find the checksum!)
# See http://en.wikipedia.org/wiki/Tar_file_format#File_format_details
100	string		0	
>148	string		0	
>>154	string		\000\040	application/x-tar

#############################
# Neal's PDF identification
0       string          %PDF-           application/x-pdf

